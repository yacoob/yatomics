# yaml-language-server: $schema=https://schema.blue-build.org/recipe-v1.json
name: yaurora
description: ðŸ’™ ublue-os/aurora-dx the way I like it
base-image: ghcr.io/ublue-os/aurora-dx
image-version: stable

# NOTE: the order of the modules in this file translates to the order of RUN lines in generated Containerfile.
modules:
  - from-file: base/chezmoi.yaml
  - from-file: base/dnf.yaml
  - from-file: base/script.yaml
  - from-file: base/files.yaml

  # /etc/os-release
  - type: os-release
    properties:
      ID: yaurora
      NAME: yaurora
      DEFAULT_HOSTNAME: yaurora
      VARIANT_ID: yaurora

  # install flatpaks
  - type: default-flatpaks@v1
    notify: true
    system:
      install:
        - com.bitwarden.desktop
        - com.discordapp.Discord
        - com.rtosta.zapzap
        - io.github.dweymouth.supersonic
        - io.github.martchus.syncthingtray
        - io.github.Qalculate.qalculate-qt
        - it.mijorus.gearlever
        - md.obsidian.Obsidian
        - org.signal.Signal
        - org.telegram.desktop
      remove:
        - io.github.dvlv.boxbuddyrs
        - org.gnome.DejaDup
        - org.gnome.World.PikaBackup
        - org.kde.gwenview
        - org.kde.kcalc
        - org.kde.okular
        - org.mozilla.Thunderbird

  # add repositories, install RPM packages
  - type: dnf
    repos:
      copr:
        - bijumon/neovide-release
        - scottames/ghostty
    install:
      install-weak-deps: false
      packages:
        - chafa
        - darktable
        - fcitx5
        - fcitx5-mozc
        - fido2-tools
        - gh
        - gwenview
        - kcm-fcitx5
        - okular
        - trash-cli
        # third party pkgs
        - ghostty
        - neovide
    remove:
      packages:
        - code
        - containerd.io
        - docker-buildx-plugin
        - docker-ce
        - docker-ce-cli
        - docker-ce-rootless-extras
        - docker-compose-plugin

  # regen initramfs to ensure clevis is included in it
  - type: initramfs

  # sign the image
  - type: signing
